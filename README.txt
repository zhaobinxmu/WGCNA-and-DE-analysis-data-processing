# WGCNA-and-DE-analysis-data-processing

#ceshi_pada_random.txt
sample ID	FE1	FE2	FE3	FE4	FE5	FE6	FE7	FE8	FE9	FE10	FE11
SP5	1.5	2.5	3.5	4.5	5.5	6.5	7.5	8.5	9.5	10.5	11.5
SP6	1.6	2.6	3.6	4.6	5.6	6.6	7.6	8.6	9.6	10.6	11.6
SP7	1.7	2.7	3.7	4.7	5.7	6.7	7.7	8.7	9.7	10.7	11.7
SP8	1.8	2.8	3.8	4.8	5.8	6.8	7.8	8.8	9.8	10.8	11.8
SP9	1.9	2.9	3.9	4.9	5.9	6.9	7.9	8.9	9.9	10.9	11.9
SP10	2	3	4	5	6	7	8	9	10	11	12
SP11	2.1	3.1	4.1	5.1	6.1	7.1	8.1	9.1	10.1	11.1	12.1
SP12	2.2	3.2	4.2	5.2	6.2	7.2	8.2	9.2	10.2	11.2	12.2
SP13	2.3	3.3	4.3	5.3	6.3	7.3	8.3	9.3	10.3	11.3	12.3
SP14	2.4	3.4	4.4	5.4	6.4	7.4	8.4	9.4	10.4	11.4	12.4
SP15	2.5	3.5	4.5	5.5	6.5	7.5	8.5	9.5	10.5	11.5	12.5
SP1	1.1	2.1	3.1	4.1	5.1	6.1	7.1	8.1	9.1	10.1	11.1
SP2	1.2	2.2	3.2	4.2	5.2	6.2	7.2	8.2	9.2	10.2	11.2
SP3	1.3	2.3	3.3	4.3	5.3	6.3	7.3	8.3	9.3	10.3	11.3
SP4	1.4	2.4	3.4	4.4	5.4	6.4	7.4	8.4	9.4	10.4	11.4


#input ceshi_padata_random.txt
ceshi_pdata_random<-read.table("ceshi_pdata_random.txt",header = T,row.names = 1,sep = "\t")

#ceshi_matrix.txt
ID_REF	SP1	SP2	SP3	SP4	SP5	SP6	SP7	SP8	SP9	SP10	SP11	SP12	SP13	SP14	SP15
11_at	32	2.1	3.1	4.1	5.1	6.1	7.1	8.1	9.1	10.1	11.1	8.1	9.1	10.1	11.1
12_at	1.2	2.2	3.2	4.2	5.2	768	7.2	8.2	9.2	10.2	11.2	8.2	9.2	10.2	11.2
13_at		2.3	3.3	77	5686	6.3	7.3	8.3	7878	10.3	65757	8.3	7878	10.3	65757
14_at	1.4	2.4	3.4	4.4	5.4	6.4	7.4	677	9.4	10.4	67	677	9.4	10.4	67
15_at	1.5	2.5	3.5	4.5	5.5	7876.5	65756	8.5	9.5	7676	11.5	8.5	9.5	7676	11.5
16_at	324	2.6	3.6	54	5.6	6.6	7.6	8.6	9.6	676	567	8.6	9.6	676	567
17_at	1.7	2.7	3.7	56878	5.7	766.7	7.7	8.7	9.7	10.7	11.7	8.7	9.7	10.7	11.7
18_at	1231	467675	5657	4.8	5.8	6.8	5454	8.8	9.8	10.8	77	8.8	9.8	10.8	77
19_at	1.9	2.9	3.9	4.9	5.9	6.9	7.9	8.9	9.9	10.9	11.9	8.9	9.9	10.9	11.9
20_at	2312	323	4	5	6	67	71	9	10	86	12	9	10	86	12
21_at	2.1	3.1	4.1	5.1	6.1	7.1	8.1	9.1	10.1	11.1	12.1	9.1	10.1	11.1	12.1
22_at	342	5	4.2	56533	6.2	7.2	8.2	454	10.2	11.2	76	454	10.2	11.2	76
23_at	2.3	3.3	4.3	55	6.3	7.3	5454	9.3	10.3	11.3	756	9.3	10.3	11.3	756
24_at	535	355	4.4	5.4	76756	7.4	8.4	9.4	10.4	11.4	756	9.4	10.4	11.4	756
25_at	2.5	3.5	4.5	5.5	6.5	7.5	8.5	9.5	10.5	11.5	7643	9.5	10.5	11.5	7643
26_at	1.9	2.9	3.9	4.9	5.9	6.9	7.9	8.5	9.5	7676	11.5	8.5	9.5	7676	11.5
27_at	2312	323	4	5	6	67	71	8.6	9.6	676	567	8.6	9.6	676	567
28_at	2.1	3.1	4.1	5.1	6.1	7.1	8.1	8.7	9.7	10.7	11.7	8.7	9.7	10.7	11.7
29_at	342	5	4.2	56533	6.2	7.2	8.2	8.8	9.8	10.8	77	8.8	9.8	10.8	77
30_at	2.3	3.3	4.3	55	6.3	7.3	5454	8.9	9.9	10.9	11.9	8.9	9.9	10.9	11.9
31_at	535	355	4.4	5.4	76756	7.4	8.4	9	10	86	12	9	10	86	12
32_at	2.5	3.5	4.5	5.5	6.5	7.5	8.5	9.1	10.1	11.1	12.1	9.1	10.1	11.1	12.1
33_at	2.5	3.5	4.5	5.5	6.5	7.5	8.5	454	10.2	11.2	76	454	10.2	11.2	76
#input ceshi_matrix
ceshi_matrix<-read.table("ceshi_matrix.txt",header = T,row.names = 1,sep = "\t")


#ceshi_DE.txt
	logFC	AveExpr	t	P.Value	adj.P.Val	B	gene	thershold
12_at	-1.2	2.2	3.2	0.0001	0.0001	6.2	AB2	down
16_at	-1.6	2.6	3.6	0.00012	0.00012	6.6	AB6	down
11_at	1.1	2.1	3.1	0.0002	0.0002	6.1	AB1	up
15_at	-1.5	2.5	3.5	0.001	0.001	6.5	AB5	down
17_at	-1.7	2.7	3.7	0.00132	0.00132	6.7	AB7	down
18_at	1.8	2.8	3.8	0.003	0.003	6.8	AB8	up
19_at	1.9	2.9	3.9	0.004	0.004	6.9	AB9	up
20_at	2	3	4	0.005	0.005	7	AB10	up
21_at	2.1	3.1	4.1	0.006	0.006	7.1	AB11	up
22_at	2.2	3.2	4.2	0.007	0.007	7.2	AB12	up
23_at	2.3	3.3	4.3	0.008	0.008	7.3	AB13	up
24_at	2.4	3.4	4.4	0.009	0.009	7.4	AB14	up
14_at	1.4	2.4	3.4	0.01	0.01	6.4	AB4	up
25_at	2.4	3.5	4.5	0.01	0.01	7.5	AB15	up
26_at	2.4	3.6	4.5	0.011	0.011	3	AB16	up
27_at	2.4	3.7	4.5	0.012	0.012	4	AB17	up
28_at	2.4	3.8	4.5	0.013	0.013	2	AB18	up
29_at	2.4	3.9	4.5	0.014	0.014	6	AB19	up
30_at	2.4	4	4.5	0.015	0.015	2	AB20	up
31_at	2.4	4.1	4.5	0.016	0.016	1	AB21	up
32_at	2.4	4.2	4.5	0.017	0.017	2	AB22	up
33_at	2.4	4.3	4.5	0.018	0.018	4	AB23	up
13_at	1.3	2.3	3.3	0.03	0.03	6.3	AB3	up
#input ceshi_DE
ceshi_DE<-read.table("ceshi_DE.txt",header = T,row.names = 1,sep = "\t")

# pick up the "up-regulated" gene from ceshi_DE
keep_ceshi_DE_UP<-(ceshi_DE$threshold=="up")
ceshi_DE_UP<- ceshi_DE[keep_ceshi_DE_UP,]

#pick up the "up-regulated" gene from ceshi_matrix
ceshi_matrix_up<-ceshi_matrix[rownames(ceshi_DE_UP),]

#WGCNA Processing
data_ceshi_matrix_up_transpose<-as.data.frame(t(ceshi_matrix_up)[,])
#将表达数据和处理匹配样本sample，ceshi_pdata_random和data_ceshi_matrix_up_transpose的sample不一致，
且data_ceshi_matrix_up_transpose是按照规则顺序排列的，则把规则的放在括号前面，括号后面的作为参照，将不规则的ceshi_pdata_random
重新排列成sample成一致性
matche_ceshi_rownames<-match( rownames(data_ceshi_matrix_up_transpose), rownames(ceshi_pdata_random))
dataTraits_ceshi=ceshi_pdata_random[matche_ceshi_rownames,]


